"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8627],{8627:(N,h,l)=>{l.r(h),l.d(h,{EditarRutaPageModule:()=>D});var m=l(6814),f=l(95),n=l(3614),g=l(9351),v=l(5861),_=l(816),a=l(9468),E=l(118),Z=l(4704);function T(e,r){1&e&&a._UZ(0,"ion-back-button",38)}function A(e,r){1&e&&(a.TgZ(0,"div",39),a._uU(1,"Seleccione un lugar de origen"),a.qZA())}function M(e,r){1&e&&(a.TgZ(0,"div",39),a._uU(1,"Ingrese una direcci\xf3n de destino"),a.qZA())}function R(e,r){1&e&&(a.TgZ(0,"div",39),a._uU(1,"Ingrese un n\xfamero"),a.qZA())}function U(e,r){1&e&&(a.TgZ(0,"div",39),a._uU(1,"Debe ser mayor a 0"),a.qZA())}function P(e,r){1&e&&(a.TgZ(0,"div",39),a._uU(1,"Hora inv\xe1lida"),a.qZA())}function C(e,r){1&e&&(a.TgZ(0,"div",39),a._uU(1,"Hora inv\xe1lida"),a.qZA())}const y=[{path:"",component:(()=>{var e;class r{constructor(i,t,o,u,q){this.navCtrl=i,this.router=t,this.activatedRoute=o,this.alertController=u,this.db=q,this.newRuta=!1,this.viewType="",this.salidaHora=0,this.salidaMinuto=0,this.formErrors={},this.activatedRoute.queryParams.subscribe(w=>{var p,s,d;null!==(p=this.router.getCurrentNavigation())&&void 0!==p&&p.extras.state?(this.ruta=null===(s=this.router.getCurrentNavigation())||void 0===s||null===(s=s.extras)||void 0===s||null===(s=s.state)||void 0===s?void 0:s.ruta,this.viewType=null===(d=this.router.getCurrentNavigation())||void 0===d||null===(d=d.extras)||void 0===d||null===(d=d.state)||void 0===d?void 0:d.viewType,-1==this.ruta.id_ruta&&(this.newRuta=!0)):this.ruta=new _.N}),console.log("@EDI:["+this.viewType+"]")}alertaEliminar(){var i=this;return(0,v.Z)(function*(){yield(yield i.alertController.create({header:i.newRuta?"\xbfCancelar creaci\xf3n de ruta?":"\xbfDesea eliminar esta ruta?",subHeader:i.newRuta?"":"Esto no se puede deshacer",buttons:[{text:"Volver",role:"cancel"},{text:"Aceptar",role:"confirm",cssClass:"color-danger",handler:()=>{if(!i.newRuta){i.db.eliminarRuta(i.ruta.id_ruta);let o=localStorage.getItem("uID");o&&i.db.leerRutasPorUsuario(o),i.db.showToast("Ruta eliminada","success")}i.navCtrl.navigateBack("/inicio-conductor")}}]})).present()})()}ngOnInit(){}ngAfterContentInit(){this.ruta&&this.ruta.hora_salida&&(this.salidaHora=this.ruta.hora_salida.substring(0,this.ruta.hora_salida.indexOf(":")),this.salidaMinuto=this.ruta.hora_salida.substring(this.ruta.hora_salida.indexOf(":")+1))}actualizarRuta(){console.log("!:actualizarRuta()"),this.formErrors={};let i=!0;if(i=this.validarTarifa()&&i,i=this.validarHora()&&i,i=this.validarMinuto()&&i,i=this.validarOrigen()&&i,i=this.validarDestino()&&i,i){this.ruta.hora_salida=this.salidaHora.toString().padStart(2,"0")+":"+this.salidaMinuto.toString().padStart(2,"0"),-1==this.ruta.id_ruta?(this.db.crearRuta(0,this.ruta.origen,this.ruta.destino,this.ruta.tarifa,this.ruta.hora_salida,this.ruta.id_usuario),this.db.showToast("Ruta creada","success")):(this.db.actualizarRuta(this.ruta.id_ruta,this.ruta.tiempo_estimado,this.ruta.origen,this.ruta.destino,this.ruta.tarifa,this.ruta.hora_salida,this.ruta.id_usuario),this.db.showToast("Ruta actualizada","success"));let t=localStorage.getItem("uID");t&&this.db.leerRutasPorUsuario(t),this.navCtrl.navigateBack("/ver-ruta",{state:{ruta:this.ruta,viewType:"view"}})}}validarTarifa(){let i=!0;return this.formErrors.tarifa_low=!1,this.formErrors.tarifa_nan=!1,(isNaN(Number(this.ruta.tarifa))||null===this.ruta.tarifa)&&(this.formErrors.tarifa_nan=!0,i=!1),this.ruta.tarifa<=0&&(this.formErrors.tarifa_low=!0,i=!1),i}validarHora(){let i=!0;return this.formErrors.hora_range=!1,this.formErrors.hora_nan=!1,(isNaN(Number(this.salidaHora))||null===this.salidaHora)&&(this.formErrors.hora_nan=!0,i=!1),(this.salidaHora<0||this.salidaHora>23)&&(this.formErrors.hora_range=!0,i=!1),i}validarMinuto(){let i=!0;return this.formErrors.minuto_range=!1,this.formErrors.minuto_nan=!1,(isNaN(Number(this.salidaMinuto))||null===this.salidaMinuto)&&(this.formErrors.minuto_nan=!0,i=!1),(this.salidaMinuto<0||this.salidaMinuto>59)&&(this.formErrors.minuto_range=!0,i=!1),i}validarOrigen(){let i=!0;return this.formErrors.origen_empty=!1,this.formErrors.origen_notExists=!1,this.ruta&&""==this.ruta.origen.trim()&&(this.formErrors.origen_empty=!0,i=!1),i}validarDestino(){let i=!0;return this.formErrors.destino_empty=!1,this.formErrors.destino_notExists=!1,""==this.ruta.destino.trim()&&(this.formErrors.destino_empty=!0,i=!1),i}eliminarRuta(){console.log("!:eliminarRuta()"),this.alertaEliminar()}}return(e=r).\u0275fac=function(i){return new(i||e)(a.Y36(n.SH),a.Y36(g.F0),a.Y36(g.gz),a.Y36(n.Br),a.Y36(E.J))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-editar-ruta"]],decls:87,vars:15,consts:[[3,"translucent"],["color","#1e1e1e"],["slot","start"],["defaultHref","/inicio-conductor","text","Cancelar",4,"ngIf"],[3,"fullscreen"],["slot","fixed","vertical","top","horizontal","end"],["size","large","color","success",3,"click"],["name","checkmark-sharp"],["size","large","color","danger",3,"click"],["name","trash-sharp"],[3,"viewType"],[1,"display-labels"],["lines","none"],[1,"display-label"],[3,"ngModel","ngModelChange","input"],["value","Av. Espa\xf1a 8, Santiago Centro"],["value","Padre Alonso de Ovalle 1586, Santiago Centro"],["value","Antonio Varas 666, Providencia"],["value","Miguel Claro 337, Providencia"],["value","Av. Esquina Blanca 501, Maip\xfa"],["value","Serrano 1105, Melipilla"],["value","Calle Nueva 1660, Huechuraba"],["value","Av. Am\xe9rico Vespucio 1501, Cerrillos"],["value","Froil\xe1n Roa 7107, La Florida"],["value","Av. Concha y Toro 1340, Puente Alto"],["value","Freire 857, San Bernardo"],["value","Av. Vicu\xf1a Mackenna 4917, San Joaqu\xedn"],["value","Av. Brasil 2021, Valpara\xedso"],["value","\xc1lvarez 2366, Chorrillos, Vi\xf1a del Mar"],["value","Camino a Carampangue 1060, Arauco"],["value","Julio Hemmelmann 200, Nacimiento"],["value","Paicav\xed 3280, Concepci\xf3n"],["value","Anfi\xf3n Mu\xf1oz 51, Villarrica"],["value","Ega\xf1a 651, Puerto Montt"],["class","formErrorMessage",4,"ngIf"],["lines","none",1,"ion-text-center"],[1,"display-values"],["type","number",3,"ngModel","ngModelChange","input"],["defaultHref","/inicio-conductor","text","Cancelar"],[1,"formErrorMessage"]],template:function(i,t){1&i&&(a.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),a.YNc(3,T,1,0,"ion-back-button",3),a.qZA()()(),a.TgZ(4,"ion-content",4)(5,"ion-fab",5)(6,"ion-fab-button",6),a.NdJ("click",function(){return t.actualizarRuta()}),a._UZ(7,"ion-icon",7),a.qZA(),a.TgZ(8,"ion-fab-button",8),a.NdJ("click",function(){return t.eliminarRuta()}),a._UZ(9,"ion-icon",9),a.qZA()(),a._UZ(10,"app-map",10),a.qZA(),a.TgZ(11,"ion-footer")(12,"ion-grid")(13,"ion-row",11)(14,"ion-col")(15,"ion-item",12)(16,"span",13),a._uU(17,"Salida"),a.qZA(),a.TgZ(18,"ion-select",14),a.NdJ("ngModelChange",function(u){return t.ruta.origen=u})("input",function(){return t.validarOrigen()}),a.TgZ(19,"ion-select-option",15),a._uU(20,"DuocUC Sede Alameda"),a.qZA(),a.TgZ(21,"ion-select-option",16),a._uU(22,"DuocUC Sede Padre Alonso de Ovalle"),a.qZA(),a.TgZ(23,"ion-select-option",17),a._uU(24,"DuocUC Sede Antonio Varas"),a.qZA(),a.TgZ(25,"ion-select-option",18),a._uU(26,"DuocUC Sede Educaci\xf3n Continua"),a.qZA(),a.TgZ(27,"ion-select-option",19),a._uU(28,"DuocUC Sede Maip\xfa"),a.qZA(),a.TgZ(29,"ion-select-option",20),a._uU(30,"DuocUC Sede Melipilla"),a.qZA(),a.TgZ(31,"ion-select-option",21),a._uU(32,"DuocUC Sede Plaza Norte"),a.qZA(),a.TgZ(33,"ion-select-option",22),a._uU(34,"DuocUC Sede Plaza Oeste"),a.qZA(),a.TgZ(35,"ion-select-option",23),a._uU(36,"DuocUC Sede Plaza Vespucio"),a.qZA(),a.TgZ(37,"ion-select-option",24),a._uU(38,"DuocUC Sede Puente Alto"),a.qZA(),a.TgZ(39,"ion-select-option",25),a._uU(40,"DuocUC Sede San Bernardo"),a.qZA(),a.TgZ(41,"ion-select-option",26),a._uU(42,"DuocUC Sede San Joaqu\xedn"),a.qZA(),a.TgZ(43,"ion-select-option",27),a._uU(44,"DuocUC Sede Valpara\xedso"),a.qZA(),a.TgZ(45,"ion-select-option",28),a._uU(46,"DuocUC Sede Vi\xf1a del Mar"),a.qZA(),a.TgZ(47,"ion-select-option",29),a._uU(48,"DuocUC Sede Arauco"),a.qZA(),a.TgZ(49,"ion-select-option",30),a._uU(50,"DuocUC Sede Nacimiento"),a.qZA(),a.TgZ(51,"ion-select-option",31),a._uU(52,"DuocUC Sede Andr\xe9s de Concepci\xf3n"),a.qZA(),a.TgZ(53,"ion-select-option",32),a._uU(54,"DuocUC Sede Villarrica"),a.qZA(),a.TgZ(55,"ion-select-option",33),a._uU(56,"DuocUC Sede Puerto Montt"),a.qZA()()(),a.YNc(57,A,2,0,"div",34),a.qZA()(),a.TgZ(58,"ion-row",11)(59,"ion-col")(60,"ion-item",12)(61,"span",13),a._uU(62,"Destino"),a.qZA(),a.TgZ(63,"ion-input",14),a.NdJ("ngModelChange",function(u){return t.ruta.destino=u})("input",function(){return t.validarDestino()}),a.qZA()(),a.YNc(64,M,2,0,"div",34),a.qZA()(),a.TgZ(65,"ion-row",11)(66,"ion-col")(67,"ion-item",35)(68,"span"),a._uU(69," Tarifa "),a.YNc(70,R,2,0,"div",34),a.YNc(71,U,2,0,"div",34),a.qZA()()(),a.TgZ(72,"ion-col")(73,"ion-item",12)(74,"span"),a._uU(75," Hora de Salida "),a.YNc(76,P,2,0,"div",34),a.YNc(77,C,2,0,"div",34),a.qZA()()()(),a.TgZ(78,"ion-row",36)(79,"ion-col")(80,"ion-item",12)(81,"ion-input",37),a.NdJ("ngModelChange",function(u){return t.ruta.tarifa=u})("input",function(){return t.validarTarifa()}),a.qZA()()(),a.TgZ(82,"ion-col")(83,"ion-item",12)(84,"ion-input",37),a.NdJ("ngModelChange",function(u){return t.salidaHora=u})("input",function(){return t.validarHora()}),a.qZA(),a._uU(85," : "),a.TgZ(86,"ion-input",37),a.NdJ("ngModelChange",function(u){return t.salidaMinuto=u})("input",function(){return t.validarMinuto()}),a.qZA()()()()()()),2&i&&(a.Q6J("translucent",!0),a.xp6(3),a.Q6J("ngIf",!t.newRuta),a.xp6(1),a.Q6J("fullscreen",!0),a.xp6(6),a.Q6J("viewType",t.viewType),a.xp6(8),a.Q6J("ngModel",t.ruta.origen),a.xp6(39),a.Q6J("ngIf",t.formErrors.origen_empty),a.xp6(6),a.Q6J("ngModel",t.ruta.destino),a.xp6(1),a.Q6J("ngIf",t.formErrors.destino_empty),a.xp6(6),a.Q6J("ngIf",t.formErrors.tarifa_nan),a.xp6(1),a.Q6J("ngIf",!t.formErrors.tarifa_nan&&t.formErrors.tarifa_low),a.xp6(5),a.Q6J("ngIf",t.formErrors.hora_range||t.formErrors.minuto_range),a.xp6(1),a.Q6J("ngIf",t.formErrors.hora_nan||t.formErrors.minuto_nan),a.xp6(4),a.Q6J("ngModel",t.ruta.tarifa),a.xp6(3),a.Q6J("ngModel",t.salidaHora),a.xp6(2),a.Q6J("ngModel",t.salidaMinuto))},dependencies:[m.O5,f.JJ,f.On,n.oU,n.Sm,n.wI,n.W2,n.IJ,n.W4,n.fr,n.jY,n.Gu,n.gu,n.pK,n.Ie,n.Nd,n.t9,n.n0,n.sr,n.as,n.QI,n.j9,n.cs,Z.G],styles:["ion-button.round-icon[_ngcontent-%COMP%]{--border-radius:50%;height:40px;width:40px;font-size:1rem}ion-select[_ngcontent-%COMP%]{overflow:hidden;overflow:clip}.display-labels[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;font-size:1rem;color:gray;padding:.2rem;width:100%}.display-label[_ngcontent-%COMP%]{display:inline-block;font-size:1rem;color:gray;min-width:100px;max-width:100px}.display-value-text[_ngcontent-%COMP%]{display:inline-block;overflow:auto}.display-values[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{display:block;font-size:2rem;padding:.2rem;text-align:center;width:100%}"]}),r})()}];let b=(()=>{var e;class r{}return(e=r).\u0275fac=function(i){return new(i||e)},e.\u0275mod=a.oAB({type:e}),e.\u0275inj=a.cJS({imports:[g.Bz.forChild(y),g.Bz]}),r})();var S=l(9464);let D=(()=>{var e;class r{}return(e=r).\u0275fac=function(i){return new(i||e)},e.\u0275mod=a.oAB({type:e}),e.\u0275inj=a.cJS({imports:[m.ez,f.u5,n.Pc,b,S.K]}),r})()}}]);